<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" href="/icon.ico"/>
	<link rel="stylesheet" href="/style.css"/>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"/>
	<link rel="stylesheet" href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css"/>
	<meta name="theme-color" content="#83254f">
	<meta property="og:title" content="Site doc: Image gallery">
	<title>Site doc: Image gallery</title>
</head>
<body>
	<div id="header">
		<div class="nav">
			<a href="/">Home</a>
			<a href="/feed.xml">Feed</a>
			<a href="/The-Iron-Ragdoll/">TIR</a>
		</div>
	</div>
	<div id="main">
		<p class="date">2025-10-18</p>

    <div class="tags">
        
            
        
            
                <a href="/tag/site-doc">#site-doc</a>
            
        
            
                <a href="/tag/webmastery">#webmastery</a>
            
        
    </div>

<h1>Site doc: Image gallery</h1>
<p>Out of boredom I'm going to write about how I did some of the stuff I did on my site. You can reference this and I hope this can help you, but remember that not everyone's use case is exactly the same, so always make sure you know what a code is doing before copying!</p>
<hr>
<details open><summary>Contents</summary><ul><li><a href="#the-data">The data</a></li><li><a href="#gallery-pages">Gallery pages</a></li><li><a href="#character-pages">Character pages</a></li></ul></details>
<h2 id="the-data" tabindex="-1">The data</h2>
<p>I keep all of my art in one huge-ass folder (all art from others being in another folder) and the data for all of them (including art from others) in a huge-ass <code>.json</code> file. Here is what <code>gallery imgs.json</code> looks like:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		<span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"sky sans cards"</span><span class="token punctuation">,</span>
		<span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"png"</span><span class="token punctuation">,</span>
		<span class="token property">"date"</span><span class="token operator">:</span> <span class="token string">"2025-06-15"</span><span class="token punctuation">,</span>
		<span class="token property">"ch"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token string">"sky"</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// ...</span>
	<span class="token punctuation">{</span>
		<span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"sparky nightsun king-lee"</span><span class="token punctuation">,</span>
		<span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"png"</span><span class="token punctuation">,</span>
		<span class="token property">"date"</span><span class="token operator">:</span> <span class="token string">"2025-07-01"</span><span class="token punctuation">,</span>
		<span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"king-lee"</span><span class="token punctuation">,</span>
		<span class="token property">"authorUrl"</span><span class="token operator">:</span> <span class="token string">"https://artfight.net/~king-lee"</span><span class="token punctuation">,</span>
		<span class="token property">"ch"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token string">"nightsun"</span><span class="token punctuation">,</span>
			<span class="token string">"sparky"</span>
		<span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token property">"comment"</span><span class="token operator">:</span> <span class="token string">"Artfight 2025 defense!"</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// ...</span>
<span class="token punctuation">]</span></code></pre>
<p>Each picture needs a <code>name</code>, <code>type</code>, and <code>date</code> property. If it doesn't have a <code>ch</code> property, then it doesn't contain any of my characters and is therefore fanart. If it's drawn by someone else, it needs <code>author</code> and <code>authorUrl</code>.</p>
<p>As of this writing, <code>gallery imgs.json</code> is 4613 lines long. Man.</p>
<p>But this isn't done yet, because I want to sort the entire file by date before using it in any capacity! 11ty allows you to make <code>.js</code> data files, which is why I have another <code>gallery.js</code> that returns the array but sorted by date.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> gallery <span class="token keyword">from</span> <span class="token string">'./gallery imgs.json'</span> <span class="token keyword">with</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> gallery<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> b<span class="token punctuation">.</span>date<span class="token punctuation">.</span><span class="token function">localeCompare</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>(I have to include <code>with {type: 'json'}</code> or 11ty throws a fit.)</p>
<p>Now in any content file, <code>gallery</code> gives access to this sorted array.</p>
<h2 id="gallery-pages" tabindex="-1">Gallery pages</h2>
<p>Now that the data's ready, all there is left is to use it! For the gallery pages, I wrote filters to get all of my own pictures from a specific month of a specific year.</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">'getOnlyMyArt'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token operator">=></span> <span class="token operator">!</span>a<span class="token punctuation">.</span>author<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">'filterGalleryByDate'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">,</span> f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>date<span class="token operator">?.</span><span class="token function">includes</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The way you use it is:</p>
<pre class="language-liquid"><code class="language-liquid"><span class="token liquid language-liquid"><span class="token delimiter punctuation">{%</span> <span class="token keyword">assign</span> myArtInJune2025 <span class="token operator">=</span> gallery <span class="token operator">|</span> <span class="token function filter">getOnlyMyArt</span> <span class="token operator">|</span> <span class="token function filter">filterGalleryByDate</span><span class="token operator">:</span> <span class="token string">"2025-06"</span> <span class="token delimiter punctuation">%}</span></span></code></pre>
<p>The way Liquid's, and most template engines' filtering chain works is basically the value before the filter is passed in as the filter's first argument â€” in this case <code>arr</code>. Any values after the filter, here it's <code>&quot;2025-06&quot;</code>, will be passed in as the 2nd, 3rd, etc. arguments. So the thing above is equivalent to this in JS:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">let</span> myArtInJune2025 <span class="token operator">=</span> <span class="token function">filterGalleryByDate</span><span class="token punctuation">(</span><span class="token function">getOnlyMyArt</span><span class="token punctuation">(</span>gallery<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"2025-06"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>(The functions <code>getOnlyMyArt</code> and <code>filterGalleryByDate</code> don't actually exist, since I registered them directly as filters, but we can pretend they do.)</p>
<p>To make the gallery pages, I made a page that has the a years data array in its frontmatter.</p>
<pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">years</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> <span class="token number">2023</span>
 <span class="token punctuation">-</span> <span class="token number">2024</span>
 <span class="token punctuation">-</span> <span class="token number">2025</span></code></pre>
<p>I have to edit this manually each year, but since it's only once a year I won't get tired doing this and attempt to automate it, LMAO.</p>
<p>I then paginated this data, so 11ty would make a page out of each of these years. Inside each year, I cycled through the 12 months, which thankfully is quite easy to do in Liquid.</p>
<pre class="language-liquid"><code class="language-liquid"><span class="token liquid language-liquid"><span class="token delimiter punctuation">{%</span> <span class="token keyword">for</span> month <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token range operator">..</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token keyword">reversed</span> <span class="token delimiter punctuation">%}</span></span>
	// ...
<span class="token liquid language-liquid"><span class="token delimiter punctuation">{%</span> <span class="token keyword">endfor</span> <span class="token delimiter punctuation">%}</span></span></code></pre>
<p>Inside each month, I filtered for my art in that month, and displayed them on the page if there was a nonzero amount. With 11ty's <code>pagination.previous</code> and <code>pagination.next</code>, I can also link to the previous and next years on this page.</p>
<h2 id="character-pages" tabindex="-1">Character pages</h2>
<p>Another place I need to show the art is in their pages! This is fairly simple as I only need to filter for all art where the <code>ch</code> property contains the character's name.</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">'filterGallery'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">,</span> f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>ch<span class="token operator">?.</span><span class="token function">includes</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>(<code>toLowerCase</code> because they are all lowercase in the data, but the name I passed in is uppercase.)</p>
<pre class="language-liquid"><code class="language-liquid"><span class="token liquid language-liquid"><span class="token delimiter punctuation">{%</span> <span class="token keyword">assign</span> filteredGallery <span class="token operator">=</span> gallery <span class="token operator">|</span> <span class="token function filter">filterGallery</span><span class="token operator">:</span> <span class="token string">"Sparky"</span> <span class="token delimiter punctuation">%}</span></span></code></pre>
<p>But as some characters' galleries grew (looking at you Sparky), it would be bad to dump all of that on their main page. I could make a gallery subpage for that character if they have more than 10 images. How can I automate that?</p>
<p>Here's a neat thing I found. 11ty's collections feature, especially the part where it lets you make your own collections, doesn't <em>have</em> to return an array of pages. You can have it return anything you like! Which is why I made it return a list of characters with more than 10 images.</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addCollection</span><span class="token punctuation">(</span><span class="token string">"charactersMoreThan10"</span><span class="token punctuation">,</span> <span class="token parameter">collection</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> characters<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">ch</span> <span class="token operator">=></span>
		gallery<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">img</span> <span class="token operator">=></span>
			img<span class="token punctuation">.</span>ch <span class="token operator">&amp;&amp;</span>
			img<span class="token punctuation">.</span>ch<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>ch<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">10</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The code above filters the <code>characters</code> array for characters with more than 10 images. You can see I never used the <code>collection</code> variable, which 11ty was supposed to pass in.</p>
<p>The <code>img.ch &amp;&amp;</code> part of the code simply ensures that when I did <code>img.ch.includes()</code>, <code>img.ch</code> wouldn't be undefined so it won't throw an error. If <code>img.ch</code> doesn't exist, the statement gets cut off so anything after <code>&amp;&amp;</code> doesn't get evaluated. But if <code>img.ch</code> <em>does</em> exist, the interpreter moves on to the part after <code>&amp;&amp;</code> and returns the last part that's true (which is the second part in this case, since there are only two parts).</p>
<p>Now I have a list of whatever characters have more than 10 images, so I can paginate that with a permalink set to be a subpage of that character!</p>
<pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">pagination</span><span class="token punctuation">:</span>
  data<span class="token punctuation">:</span> collections.charactersMoreThan10
  size<span class="token punctuation">:</span> <span class="token number">1</span>
  alias<span class="token punctuation">:</span> ch
  addAllPagesToCollections<span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">permalink</span><span class="token punctuation">:</span> <span class="token string">"characters/{{ ch.name | lowerCase }}/gallery/"</span></code></pre>
<p>On the characters' main pages, I also filtered for the first 10 images in their gallery, and linked to the subpage if they had more than 10 pieces. Wonderfully fully-automated big galleries. I love 'em.</p>

<hr/>


<div class="prev-next">
    <p><a href="/posts/2025-10-15.html">&lt;==</a></p>
    <p><a href="/">Home</a></p>
    <p><a href="/posts/2025-10-26.html">==&gt;</a></p>
</div>

	</div>
</body>